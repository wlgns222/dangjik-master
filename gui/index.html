<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dangjik Master</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="wizard-card">
    <div class="progress-stepper" style="display: none">
        <div class="step-line"></div>
        <div class="step-dot" id="dot-1">1</div>
        <div class="step-dot" id="dot-2">2</div>
        <div class="step-dot" id="dot-3">3</div>
        <div class="step-dot" id="dot-4">4</div>
    </div>

    <form id="wizardForm">
        <div class="step-content active" id="step-0">
            <div style="text-align: center;">
                <h2 style="font-size: 35px; margin-bottom: 8px;">당직 마스터</h2>
                <p>근무 자동 배정 시스템</p>
                <div class="btn-group" style="flex-direction: column;">
                    <button type="button" class="btn-next" onclick="moveStep(1)">시작하기</button>
                    <button type="button" class="btn-prev" onclick="moveStep('help')">도움말</button>
                </div>
            </div>
        </div>

        <div class="step-content" id="step-1">
            <h2>인원 및 열외 명부 등록</h2>
            <p>용사 명단과 열외 일정 CSV 파일을 선택해 주세요.</p>
            <div class="input-box">
                <label>용사 명단</label>
                <input type="file" id="workerFile" accept=".csv">
            </div>
            <div class="input-box">
                <label>열외 일정</label>
                <input type="file" id="exceptionFile" accept=".csv">
            </div>
            <div class="btn-group">
                <button type="button" class="btn-prev" onclick="moveStep(0)">이전</button>
                <button type="button" class="btn-next" onclick="moveStep(2)">다음</button>
            </div>
        </div>

        <div class="step-content" id="step-2">
            <h2>근무 배정 기간 설정</h2>
            <p>근무표를 생성할 기간과 식기 기준일을 입력하세요.</p>
            <div style="display: flex; gap: 12px;">
                <div class="input-box" style="flex:1;">
                    <label>시작일</label>
                    <input type="date" id="startDate">
                </div>
                <div class="input-box" style="flex:1;">
                    <label>종료일</label>
                    <input type="date" id="endDate">
                </div>
            </div>
            <div class="input-box">
                <label>72사단 마지막 식기 당번일</label>
                <input type="date" id="ldDate">
            </div>
            <div class="btn-group">
                <button type="button" class="btn-prev" onclick="moveStep(1)">이전</button>
                <button type="button" class="btn-next" onclick="moveStep(3)">다음</button>
            </div>
        </div>

        <div class="step-content" id="step-3">
            <h2>마지막 근무자 지정</h2>
            <p>각 보직별 마지막 근무자의 군번을 입력하세요.</p>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <input type="text" id="lastSub" placeholder="위병부조장">
                <input type="text" id="lastDish" placeholder="식기">
                <input type="text" id="lastSr" placeholder="선임초병">
                <input type="text" id="lastJr" placeholder="후임초병">
                <input type="text" id="lastNight" placeholder="불침번">
                <input type="text" id="lastCctv" placeholder="CCTV">
            </div>
            <div class="btn-group">
                <button type="button" class="btn-prev" onclick="moveStep(2)">이전</button>
                <button type="button" class="btn-next" onclick="moveStep(4)">다음</button>
            </div>
        </div>

        <div class="step-content" id="step-4">
            <h2>근무 배정 준비 완료</h2>
            <p>모든 설정이 완료되었습니다. 배정 엔진을 실행할까요?</p>
            <div id="logWindow">> Ready to Deploy...</div>
            <div class="btn-group">
                <button type="button" class="btn-prev" onclick="moveStep(3)">이전</button>
                <button type="button" class="btn-next" id="runButton">근무표 생성</button>
            </div>
        </div>
    </form>

    <div id="helpContainer">
        <div class="help-content active" id="h-step-0">
            <div class="help-scroll-area">
                <h2 class="help-title">데이터 준비</h2>
            
                <div class="info-box">
                    <strong>⚠️ 필수 준수사항</strong>
                    <ul style="font-size: 14px; padding-left: 20px; line-height: 1.8; margin-top: 8px;">
                        <li>파일 형식: 반드시 <strong>CSV (쉼표로 구분)</strong> (한셀에서 '다른 이름으로 저장')</li>
                        <li>날짜 형식: <strong>YYYY-MM-DD</strong> (예: 2026-01-01)</li>
                        <li>군번 일치: 두 파일의 <strong>군번이 정확히 일치</strong>해야 동일인물로 인식합니다.</li>
                    </ul>
                </div>
        
                <hr class="help-hr">
        
                <section class="help-section">
                    <h3 class="help-section-h3">1. 용사 명단</h3>
                    <p class="text-small text-desc">용사 명단에는 <strong>군번, 이름, 전입일, 전역일, 가능근무</strong>가 포함됩니다.</p>
                    
                    <table class="example-table">
                        <thead>
                            <tr>
                                <th>군번</th><th>이름</th><th>전입일</th><th>전역일</th><th>가능근무</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>25-760003</td><td>박필승</td><td>2025-01-11</td><td>2026-05-11</td><td>11111</td>
                            </tr>
                            <tr style="background: #f8fafc;">
                                <td>25-760053</td><td>방수호</td><td>2025-09-21</td><td>2027-01-21</td><td><strong>11101</strong></td>
                            </tr>
                        </tbody>
                    </table>
        
                    <div class="tip-box">
                        <strong style="color: #854d0e; font-size: 14px;"> 가능근무 판정법</strong>
                        <p style="font-size: 13px; line-height: 1.6; margin-top: 5px; color: #713f12;">
                            순서: <strong>위병부조장 - 식기 - 불침번 - 초병 - CCTV</strong><br>
                            • 1 : 가능 / 0 불가능<br>
                            • <strong>박필승(11111):</strong> 모든 근무 가능<br>
                            • <strong>방수호(11101):</strong> 4번째가 0이므로 <strong>초병 근무 불가</strong>
                        </p>
                    </div>
                </section>
        
                <section class="help-section" style="margin-bottom: 30px;">
                    <h3 class="help-section-h3" >2. 열외 명단</h3>
                    <p class="text-small text-desc">열외 명단에는 <strong>군번, 이름, 시작일, 종료일, 사유</strong>가 포함됩니다.</p>
            
                    <table class="example-table">
                        <thead>
                            <tr>
                                <th>군번</th><th>이름</th><th>시작일</th><th>종료일</th><th>사유</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>25-760070</td><td>백두산</td><td>2026-01-01</td><td>2026-01-29</td><td>신병보호</td>
                            </tr>
                            <tr style="background: #f8fafc;">
                                <td>25-760014</td><td>권번개</td><td>2026-01-15</td><td>2026-01-28</td><td>5대기</td>
                            </tr>
                        </tbody>
                    </table>
                </section>
            </div>
            <div class="btn-group">
                <button type="button" class="btn-prev" onclick="exitHelp()">이전</button>
                <button type="button" class="btn-next" onclick="moveHelp(1)">다음</button>
            </div>
        </div>
    
        <div class="help-content" id="h-step-1">
            <div class="help-scroll-area">
                <h2 class="help-title">시스템 가동 절차</h2>
                <section style="margin-top: 20px;">
                    <h3 class="help-section-h3">Step 1 & 2. 데이터 등록 및 기간 설정</h3>
                    <p class="text-small" style="margin-bottom: 10px;">
                        준비한 <strong>용사 명단/열외 일정 CSV</strong>를 업로드하고,<br>
                        근무를 배정할 <strong>시작일~종료일</strong> 및 <strong>72사단의 마지막 식기일</strong>을 선택합니다.
                    </p>
                </section>
        
                <hr class="help-hr">
        
                <section>
                    <h3 class="help-section-h3">Step 3. 마지막 근무자 입력 (중요)</h3>
                    <p class="text-small" style="margin-bottom: 10px;">
                        연속성 있는 배정을 위해 <strong>배정 직전 날</strong>의 근무자 군번을 입력합니다.
                    </p>
                    
                    <div class="standard-box">
                        <strong>입력 기준</strong>
                        <ul style="padding-left: 20px; line-height: 1.7; margin-top: 5px;">
                            <li><strong>식기:</strong> 근무자 3명 중 <strong>순번이 가장 아래</strong>인 인원</li>
                            <li><strong>불침번:</strong> 마지막 번초인 <strong>불침번 6번</strong> 인원</li>
                            <li><strong>초병(선/후임):</strong> 마지막 번초인 <strong>초병 2조</strong> 인원</li>
                            <li><strong>CCTV:</strong> 마지막 번초인 <strong>CCTV 6번 중 순번이 가장 아래</strong>인 인원</li>
                        </ul>
                    </div>
                    
                    <p class="text-xs text-danger" style="margin-top: 8px;">
                        ※ 예: 2월 1일부터 배정 시, 1월 31일의 마지막 근무자 군번을 입력
                    </p>
                </section>
        
                <hr class="help-hr">
        
                <section style="margin-bottom: 30px;">
                    <h3 class="help-section-h3">Step 4. 근무 배정 및 추출</h3>
                    <p class="text-small">시스템은 아래 우선순위로 근무를 자동 분배합니다:</p>
                    <div class="flow-box">
                        열외 제외 ➔ 부조장 ➔ 식기 ➔ 불침번 ➔ 초병 ➔ CCTV
                    </div>
                    <p class="text-xs text-muted" style="margin-top: 10px;">
                        배정이 완료되면 결과가 포함된 <strong>CSV 파일이 자동으로 다운로드</strong>됩니다.
                    </p>
                </section>
            </div>
            <div class="btn-group">
                <button type="button" class="btn-prev" onclick="moveHelp(0)">이전</button>
                <button type="button" class="btn-next" onclick="exitHelp()">다음</button>
            </div>
        </div>
    </div>
</div>

<script src="ui-controller.js"></script>
<script src="script.js"></script>
</body>
</html>
